{
    "model": {
        "model_name": "meta-llama/Llama-2-7b-hf",
        "model_dtype": "bf16",
        "model_method": "arch14",
        "model_structure": "llama",
        "save_ckp": "ckp/arch14-3.pth",
        "load_ckp": null,
        "config": "config/arch14-1024.json",
        "device_map": {
            "encoder.encoder.base_model.model.model.embed_tokens": 0,
            "encoder.encoder.base_model.model.model.layers.0": 0,
            "encoder.encoder.base_model.model.model.layers.1": 0,
            "encoder.encoder.base_model.model.model.layers.2": 0,
            "encoder.encoder.base_model.model.model.layers.3": 0,
            "encoder.encoder.base_model.model.model.layers.4": 0,
            "encoder.encoder.base_model.model.model.layers.5": 0,
            "encoder.encoder.base_model.model.model.layers.6": 0,
            "encoder.encoder.base_model.model.model.layers.7": 0,
            "encoder.encoder.base_model.model.model.layers.8": 1,
            "encoder.encoder.base_model.model.model.layers.9": 1,
            "encoder.encoder.base_model.model.model.layers.10": 1,
            "encoder.encoder.base_model.model.model.layers.11": 1,
            "encoder.encoder.base_model.model.model.layers.12": 1,
            "encoder.encoder.base_model.model.model.layers.13": 1,
            "encoder.encoder.base_model.model.model.layers.14": 1,
            "encoder.encoder.base_model.model.model.layers.15": 1,
            "encoder.encoder.base_model.model.model.layers.16": 2,
            "encoder.encoder.base_model.model.model.layers.17": 2,
            "encoder.encoder.base_model.model.model.layers.18": 2,
            "encoder.encoder.base_model.model.model.layers.19": 2,
            "encoder.encoder.base_model.model.model.layers.20": 2,
            "encoder.encoder.base_model.model.model.layers.21": 2,
            "encoder.encoder.base_model.model.model.layers.22": 2,
            "encoder.encoder.base_model.model.model.layers.23": 2,
            "encoder.encoder.base_model.model.model.layers.24": 3,
            "encoder.encoder.base_model.model.model.layers.25": 3,
            "encoder.encoder.base_model.model.model.layers.26": 3,
            "encoder.encoder.base_model.model.model.layers.27": 3,
            "encoder.encoder.base_model.model.model.layers.28": 3,
            "encoder.encoder.base_model.model.model.layers.29": 3,
            "encoder.encoder.base_model.model.model.layers.30": 3,
            "encoder.encoder.base_model.model.model.layers.31": 3,
            "encoder.encoder.base_model.model.model.norm": 3,
            "encoder.encoder.base_model.model.lm_head": 3,
            "encoder.encoder.base_model.model.i_bias": 3,
            "encoder.encoder.base_model.model.f_bias": 3,
            "encoder.encoder.base_model.model.o_bias": 3,
            "encoder.encoder.base_model.model.g_bias": 3,
            "decoder.decoder.base_model.model.model.embed_tokens": 0,
            "decoder.decoder.base_model.model.model.layers.0": 0,
            "decoder.decoder.base_model.model.model.layers.1": 0,
            "decoder.decoder.base_model.model.model.layers.2": 0,
            "decoder.decoder.base_model.model.model.layers.3": 0,
            "decoder.decoder.base_model.model.model.layers.4": 0,
            "decoder.decoder.base_model.model.model.layers.5": 0,
            "decoder.decoder.base_model.model.model.layers.6": 0,
            "decoder.decoder.base_model.model.model.layers.7": 0,
            "decoder.decoder.base_model.model.model.layers.8": 1,
            "decoder.decoder.base_model.model.model.layers.9": 1,
            "decoder.decoder.base_model.model.model.layers.10": 1,
            "decoder.decoder.base_model.model.model.layers.11": 1,
            "decoder.decoder.base_model.model.model.layers.12": 1,
            "decoder.decoder.base_model.model.model.layers.13": 1,
            "decoder.decoder.base_model.model.model.layers.14": 1,
            "decoder.decoder.base_model.model.model.layers.15": 1,
            "decoder.decoder.base_model.model.model.layers.16": 2,
            "decoder.decoder.base_model.model.model.layers.17": 2,
            "decoder.decoder.base_model.model.model.layers.18": 2,
            "decoder.decoder.base_model.model.model.layers.19": 2,
            "decoder.decoder.base_model.model.model.layers.20": 2,
            "decoder.decoder.base_model.model.model.layers.21": 2,
            "decoder.decoder.base_model.model.model.layers.22": 2,
            "decoder.decoder.base_model.model.model.layers.23": 2,
            "decoder.decoder.base_model.model.model.layers.24": 3,
            "decoder.decoder.base_model.model.model.layers.25": 3,
            "decoder.decoder.base_model.model.model.layers.26": 3,
            "decoder.decoder.base_model.model.model.layers.27": 3,
            "decoder.decoder.base_model.model.model.layers.28": 3,
            "decoder.decoder.base_model.model.model.layers.29": 3,
            "decoder.decoder.base_model.model.model.layers.30": 3,
            "decoder.decoder.base_model.model.model.layers.31": 3,
            "decoder.decoder.base_model.model.model.norm": 3,
            "decoder.decoder.base_model.model.lm_head": 3,
            "i_gate": 3,
            "f_gate": 3,
            "o_gate": 3,
            "g_gate": 3
        }
    },

    "train": {
        "train_iters": 40000,
        "max_lr": 1e-5,
        "warmup": 0.0025,
        "beta1": 0.9,
        "beta2": 0.95,
        "weight_decay": 0,
        "corpus": [
            {
                "data": "/data/lwh/activation-beacon-new/gpt/one_detail_book.train.8K.json",
                "conf": "config/conversation_trunc32k.json",
                "partition": 0.425
            },
            {
                "data": "/data/lwh/activation-beacon-new/gpt/one_detail_paper.train.8K.json",
                "conf": "config/conversation_trunc32k.json",
                "partition": 0.13
            },
            {
                "data": "/data/lwh/activation-beacon-new/longalpaca/train.json",
                "conf": "config/conversation_trunc32k.json",
                "partition": 0.3
            },
            {
                "data": "/data/lwh/activation-beacon-new/booksum/train.8K.json",
                "conf": "config/conversation_trunc32k.json",
                "partition": 0.12
            },
            {
                "data": "/data/lwh/activation-beacon-new/needle/train.8K.json",
                "conf": "config/conversation_trunc32k.json",
                "partition": 0.025
            }
        ],
        "accum_grad": 1,
        "clip_grad": 1.0,

        "save": 1000,
        "eval": 1000,
        "tasks": []
    }
}